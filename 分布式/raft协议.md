# raft协议

#### 1. raft协议是什么？ (2_20241218)
raft协议是一种强leader型的分布式共识算法，其相比paxos算法效率较高，更易于理解，易于工程时间。

#### 2. raft 包含几个子问题？ (2_20241218)
1. leader选举: 强leader节点，负责读写流量
2. 日志复制: 日志状态机，保障主从数据一致性
3. 安全性: 对日志复制和leader选举做一定的限制，至少要保证从节点拥有主节点所有已提交的数据

#### 3. raft协议节点角色？  (2_20241218)
1. follower， 跟随者
2. candidate，候选者
3. leader，领导者，负责读写流量

#### 4. 选举过程？  (2_20241218)
![image](https://github.com/user-attachments/assets/a9e97217-52c1-4ba6-b0c6-9dd62aabd0d9)


1. follower 节点会初始化一个计时器，计时器到期还没有收到leader节点心跳，就会转变成candidate节点
2. 然后candidate节点首先投自己一片，然后向其他各个节点发送投票
3. 其他节点如果本轮还没有投票，那就投给它，candidate获取半数节点以上节点，就成为新的leader节点



#### 5. 日志复制过程？  (2_20241218)

![image](https://github.com/user-attachments/assets/0324a982-0bce-4687-8526-8978e6ee02ad)

日志复制到半数以上节点，才可以被应用到状态机


#### 6. follower如何知道目前已经提交到状态机的日志索引？ (2_20241218)
leader定期发送心跳包，包含了其所应用到状态机的下标

#### 7. 如何解决网络抖动问题？  (2_20241218)

![image](https://github.com/user-attachments/assets/d28a072b-c05a-46b1-8c8e-a86cfea27b2c)

携带上一条日志的term，index，否则拒绝接受本次日志。

一致性检查机制

#### 8. 新leader节点上线，发现follower节点与其日志不一致怎么办？ (2_20241218)
leader节点保存了下一个要往个节点的索引值，如果发现不一致则索引值减一，极端情况，全都全部发送。


#### 9. 选举安全性保障？ (2_20241218)
candidate投票需要携带最新日志，follower收到后，和自己的做对比，比自己新才投给他，否则不投。意味着获得大多数票其他，他的日志肯定都是已提交的数据


#### 10. 日志复制安全性保障？ (2_20241218)
leader节点只允许提交包含当前任期内的日志

#### 11. 日志无线增长问题？ (2_20241218)
快照机制 


#### 12. 
