# undo、redo、binlog日志

#### 1. 什么是redo log日志？ (2_2024_02_29)
redo log日志是用来保证InnoDb存储引擎事物的持久性的，其主要作用用于数据库的崩溃恢复。

undo log日志由两部分组成:
1. 在内存中的redo log buffer
2. 在次盘中的redo log file

当我们对数据库只想DML操作的时候就会产生redo log日志。

#### 2. 什么时候会生成redo log日志呢？  (2_2024_02_29)
DML操作，事物，修改索引等等，理论上修改数据页，而又没有立刻落盘的操作，都应该记录redo log 日志

#### 3. 可不可以不写日志，直接写磁盘呢？ (2_2024_02_29)
当然可以，每次修改数据页都进行一次落盘操作，不过对数据页的修改是随机的，落盘操作也将是随机磁盘IO效率较低，而先写日志，再由后台线程将数据页落盘这样效率会更高，
因为日志的落盘是磁盘顺序写。

#### 4. redo log日志的整体流程是怎么样的？ (2_2024_02_29)
1. 读磁盘数据复制到内存当中，修改内存中的数据页
2. 生成redoo log 日志，记录到redo log buffer当中
3. commit 之前将redo log日志刷新到磁盘上
4. 选择恰当的时间，将脏数据页刷新到磁盘上

#### 5. 什么是Force-log-at-commit机制？  (2_2024_02_29)
Force-log-at-commit要求，再事务提交之前，其所产生的日志要先持久化到磁盘。

write是异步非阻塞的，数据只会被写到操作系统的缓存当中， 并不会立即刷新到磁盘，必须在commit之前调用一个fsycn函数，这个函数同步阻塞的，必须等数据落盘之后才返回
，确保事物的持久性。

#### 6. 那怎么恢复数据？ (2_2024_02_29)
redo log日志记录的是对数据页的修改操作，直接再执行一次redo log日志即可

#### 7. undo log于redo log日志是叛过程吗？ (2_2024_02_29)
redo log日志和undo log日志不是逆过程，redo log日志用户数据库崩溃恢复，而undo log用于支持事物会滚和mvcc的。并且两者记录的内容完全不一样，redo log日志记录的是对数
数据页的修改，而undo log日志记录的是记录的历史版本。

#### 8. 什么是binlog日志？  (2_2024_02_29)
binlog日志的使用场景通常是主从同步，数据备份。在执行数据的增、删、改操作的时候就会生成binlog日志，里面记录了操作类型，以及操作结果。





参考资料:
1. https://www.xiaolincoding.com/mysql/log/how_update.html#%E4%B8%BA%E4%BB%80%E4%B9%88%E9%9C%80%E8%A6%81-redo-log
